# REST API для отправки данных о перевалах

Этот REST API позволяет отправлять данные о перевалах на сервер. API принимает JSON данные о перевале и возвращает результат операции в виде JSON объекта.

## Задача

Задача заключалась в создании базы данных, написании класса для работы с базой данных и реализации метода POST /submitData для отправки данных о перевале.

## Информация о файлах
* `convert_img.py`: код для конвертации изображения в строку
* `DatabaseHandler.py`: код для работы с базой данных
* `test.json`: тестовые данные
* `tests`: Директория с тестами API и класса DatabaseHandler
* `submitData.py`: методы API 
* `test_1.png`: пример вывода теста API
* `read.me`: примеры вызова REST API curl

## Методы API

### POST /submitData

Этот метод принимает JSON данные о перевале и отправляет их на сервер. Данные о перевале должны содержать следующие поля:

* `beauty_title`: название перевала
* `title`: название перевала
* `other_titles`: другие названия перевала
* `connect`: что соединяет перевал
* `add_time`: время добавления перевала
* `user`: информация о пользователе, который отправил данные о перевале
	+ `email`: адрес электронной почты пользователя
	+ `fam`: фамилия пользователя
	+ `name`: имя пользователя
	+ `otc`: отчество пользователя
	+ `phone`: телефон пользователя
* `coords`: координаты перевала
	+ `latitude`: широта перевала
	+ `longitude`: долгота перевала
	+ `height`: высота перевала
* `level`: уровень сложности перевала
	+ `winter`: уровень сложности зимой
	+ `summer`: уровень сложности летом
	+ `autumn`: уровень сложности осенью
	+ `spring`: уровень сложности весной
* `images`: изображения перевала
	+ `data`: данные изображения
	+ `title`: название изображения

Результат метода:

* `status`: код HTTP
	+ 500: ошибка при выполнении операции
	+ 400: Bad Request (при нехватке полей)
	+ 200: успех
* `message`: строка с причиной ошибки или сообщением об успехе
* `id`: идентификатор добавленной записи

### GET /submitData/<id>

Этот метод возвращает информацию о перевале по его идентификатору.

### PATCH /submitData/<id>

Этот метод обновляет информацию о перевале по его идентификатору.

### GET /submitData/?user__email=<email>

Этот метод возвращает список данных о перевалах, которые были отправлены пользователем с указанным адресом электронной почты.

## Документация

Документация к API написана с помощью Swagger.
Рекомендую также посмотреть установленные библиотеки в `requirements.txt`

## Тесты

### Результаты тестирования

#### Тесты класса DatabaseHandler

| Тест | Результат |
| --- | --- |
| test_add_user | PASSED |
| test_add_coord | PASSED |
| test_add_pereval | PASSED |

**Время выполнения:** 0.66s

#### Тесты API

| Тест | Результат |
| --- | --- |
| test_submit_data | PASSED |
| test_get_submit_data | PASSED |
| test_patch_submit_data | PASSED |

#### Пример вывода:
![Результаты тестирования](test_1.png)

**Время выполнения:** 6.86s

### Общий результат

* Всего тестов: 6
* Успешных тестов: 6
* Время выполнения всех тестов: 7.52s

Примечание: Тесты были запущены с помощью pytest в среде Pycharm.


REST API тестировался можно использовать CURL. Выполнить эту команду:

#### Запросы curl лежат в `read.me`

В коде есть проверка на уникальный ключ, поэтому запрос не будет работать, если вы будете использовать его ещё раз,
не изменив параметры.